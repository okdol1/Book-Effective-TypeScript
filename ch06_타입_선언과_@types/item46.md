# 타입 선언과 관련된 세 가지 버전 이해하기

타입스크립트에서 의존성 관리는 더 복잡하다.
타입스크립트를 사용하면 다음 세 가지 사항을 추가로 고려해야 하기 때문이다.

- 라이브러리의 버전
- 타입 선언(@types)의 버전
- 타입스크립트의 버전

세 가지 버전 중 하나라도 맞지 않으면 오류가 발생할 수 있다. 이렇게 발생한 오류의 원인을 파악하고 고치기 위해서는 타입스크립트 라이브러리 관리의 복잡한 메커니즘을 모두 이해해야 한다.

타입스크립트에서 일반적으로 의존성을 사용하는 방식은 다음과 같다.

```
$ npm install react
+ react@16.8.6

$ npm install --save-dev @types/react
+ @types/react@16.8.19
```

실제 라이브러리와 타입 정보의 버전이 별도로 관리되는 방식은 다음 네 가지 문제점이 있다.

1. 라이브러리를 업데이트했지만 실수로 타입 선언은 업데이트 하지 않는 경우

   - 해결책: 타입 선언도 업데이트하여 라이브러리와 버전을 맞춘다.

2. 라이브러리보다 타입 선언의 버전이 최신인 경우

   - 해결책: 라이브러리와 타입 선언의 버전이 맞도록 라이브러리 버전을 올리거나 타입 선언의 버전을 내린다.

3. 프로젝트에서 사용하는 타입스크립트 버전보다 라이브러리에서 필요로 하는 타입스크립트 버전이 최신인 경우

   - 해결책: 프로젝트의 타입스크립트 버전을 올리거나, 라이브러리 타입 선언의 버전을 원래대로 내리거나, declare module 선언으로 라이브러리의 타입 정보를 없애 버린다.

4. @types 의존성이 중복될 수 있다

```
node+modules/
	@types/
	foo/
		index.d.ts @1.2.3
	bar/
		index.d.ts
		node_modules/
			@types/
				foo/
					index.d.ts @2.3.4
```

만약 @types/foo와 @types/bar에 의존하는 경우를 가정해보자. 만약 @types/bar가 현재 프로젝트의 호환되지 않는 버전의 @types/foo에 의존한다면 npm은 중첩된 폴더에 별도로 해당 버전을 설치하여 문제를 해결하려고 한다.

런타임에 사용되는 모듈이라면 괜찮을 수 있지만, 전역 네임스페이스(name-space)에 있는 타입 선언 모듈이라면 대부분 문제가 발생한다.

- 해결책: 보통 @types/foo를 없데이트 하거나 @types/bar를 업데이트해서 서로 버전이 호환되게 한다
